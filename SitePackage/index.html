
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for the UAntwerpen-modules repository">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.2.5">
    
    
      
        <title>The SitePackage.lua file and its included LUA files - UAntwerpen-modules documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2d9f7617.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#the-sitepackagelua-file-and-its-included-routines" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="UAntwerpen-modules documentation" class="md-header__button md-logo" aria-label="UAntwerpen-modules documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            UAntwerpen-modules documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              The SitePackage.lua file and its included LUA files
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent=""  aria-hidden="true"  type="radio" name="__palette" id="__palette_1">
          
        
      </form>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="UAntwerpen-modules documentation" class="md-nav__button md-logo" aria-label="UAntwerpen-modules documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    UAntwerpen-modules documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../design_decisions/" class="md-nav__link">
        Design decisions
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../design_considerations/" class="md-nav__link">
        Design considerations
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../modules_calcua-init/" class="md-nav__link">
        The CalcUA-init module
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../modules_calcua_and_clusterarch/" class="md-nav__link">
        The generic calcua and clusterarch modules
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          The SitePackage.lua file and its included LUA files
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        The SitePackage.lua file and its included LUA files
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#etcsystemdefinitionlua" class="md-nav__link">
    etc/SystemDefinition.lua
  </a>
  
    <nav class="md-nav" aria-label="etc/SystemDefinition.lua">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#calcua_systemtable" class="md-nav__link">
    CalcUA_SystemTable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calcua_systemproperies" class="md-nav__link">
    CalcUA_SystemProperies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calcua_clustermap" class="md-nav__link">
    CalcUA_ClusterMap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calcua_toolchain_map" class="md-nav__link">
    CalcUA_toolchain_map
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calcua_map_arch_hierarchy" class="md-nav__link">
    CalcUA_map_arch_hierarchy
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sitepackage_map_toolchainlua" class="md-nav__link">
    SitePackage_map_toolchain.lua
  </a>
  
    <nav class="md-nav" aria-label="SitePackage_map_toolchain.lua">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-structures" class="md-nav__link">
    Data structures
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#routines" class="md-nav__link">
    Routines
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sitepackage_arch_hierarchylua" class="md-nav__link">
    SitePackage_arch_hierarchy.lua
  </a>
  
    <nav class="md-nav" aria-label="SitePackage_arch_hierarchy.lua">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-structures_1" class="md-nav__link">
    Data structures
  </a>
  
    <nav class="md-nav" aria-label="Data structures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#map_os_long_to_short" class="md-nav__link">
    map_os_long_to_short
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#map_cpu_long_to_short" class="md-nav__link">
    map_cpu_long_to_short
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#map_accel_long_to_short" class="md-nav__link">
    map_accel_long_to_short
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#routines_1" class="md-nav__link">
    Routines
  </a>
  
    <nav class="md-nav" aria-label="Routines">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#discover-the-architecture-hierarchy" class="md-nav__link">
    Discover the architecture hierarchy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapping-between-different-formats-of-names" class="md-nav__link">
    Mapping between different formats of names
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extracting-parts-from-the-os-cpu-accelerator-strings" class="md-nav__link">
    Extracting parts from the os-cpu-accelerator strings:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#computing-directories" class="md-nav__link">
    Computing directories
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sitepackage_system_infolua" class="md-nav__link">
    SitePackage_system_info.lua
  </a>
  
    <nav class="md-nav" aria-label="SitePackage_system_info.lua">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-structures_2" class="md-nav__link">
    Data structures
  </a>
  
    <nav class="md-nav" aria-label="Data structures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mappings-to-long-names" class="md-nav__link">
    Mappings to long names
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mappings-to-short-names" class="md-nav__link">
    Mappings to short names
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-data-structures" class="md-nav__link">
    Other data structures
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#routines_2" class="md-nav__link">
    Routines
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sitepackage_helperlua" class="md-nav__link">
    SitePackage_helper.lua
  </a>
  
    <nav class="md-nav" aria-label="SitePackage_helper.lua">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-structures_3" class="md-nav__link">
    Data structures
  </a>
  
    <nav class="md-nav" aria-label="Data structures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#calcua_sorted_archmap_keys" class="md-nav__link">
    CalcUA_sorted_archmap_keys
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#routines_3" class="md-nav__link">
    Routines
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../easybuild/" class="md-nav__link">
        EasyBuild configuration
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../directory_structure/" class="md-nav__link">
        Directory structure of the repositories and software stack
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../procedures/" class="md-nav__link">
        Procedures
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#etcsystemdefinitionlua" class="md-nav__link">
    etc/SystemDefinition.lua
  </a>
  
    <nav class="md-nav" aria-label="etc/SystemDefinition.lua">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#calcua_systemtable" class="md-nav__link">
    CalcUA_SystemTable
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calcua_systemproperies" class="md-nav__link">
    CalcUA_SystemProperies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calcua_clustermap" class="md-nav__link">
    CalcUA_ClusterMap
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calcua_toolchain_map" class="md-nav__link">
    CalcUA_toolchain_map
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calcua_map_arch_hierarchy" class="md-nav__link">
    CalcUA_map_arch_hierarchy
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sitepackage_map_toolchainlua" class="md-nav__link">
    SitePackage_map_toolchain.lua
  </a>
  
    <nav class="md-nav" aria-label="SitePackage_map_toolchain.lua">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-structures" class="md-nav__link">
    Data structures
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#routines" class="md-nav__link">
    Routines
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sitepackage_arch_hierarchylua" class="md-nav__link">
    SitePackage_arch_hierarchy.lua
  </a>
  
    <nav class="md-nav" aria-label="SitePackage_arch_hierarchy.lua">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-structures_1" class="md-nav__link">
    Data structures
  </a>
  
    <nav class="md-nav" aria-label="Data structures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#map_os_long_to_short" class="md-nav__link">
    map_os_long_to_short
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#map_cpu_long_to_short" class="md-nav__link">
    map_cpu_long_to_short
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#map_accel_long_to_short" class="md-nav__link">
    map_accel_long_to_short
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#routines_1" class="md-nav__link">
    Routines
  </a>
  
    <nav class="md-nav" aria-label="Routines">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#discover-the-architecture-hierarchy" class="md-nav__link">
    Discover the architecture hierarchy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapping-between-different-formats-of-names" class="md-nav__link">
    Mapping between different formats of names
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extracting-parts-from-the-os-cpu-accelerator-strings" class="md-nav__link">
    Extracting parts from the os-cpu-accelerator strings:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#computing-directories" class="md-nav__link">
    Computing directories
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sitepackage_system_infolua" class="md-nav__link">
    SitePackage_system_info.lua
  </a>
  
    <nav class="md-nav" aria-label="SitePackage_system_info.lua">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-structures_2" class="md-nav__link">
    Data structures
  </a>
  
    <nav class="md-nav" aria-label="Data structures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mappings-to-long-names" class="md-nav__link">
    Mappings to long names
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mappings-to-short-names" class="md-nav__link">
    Mappings to short names
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-data-structures" class="md-nav__link">
    Other data structures
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#routines_2" class="md-nav__link">
    Routines
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sitepackage_helperlua" class="md-nav__link">
    SitePackage_helper.lua
  </a>
  
    <nav class="md-nav" aria-label="SitePackage_helper.lua">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-structures_3" class="md-nav__link">
    Data structures
  </a>
  
    <nav class="md-nav" aria-label="Data structures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#calcua_sorted_archmap_keys" class="md-nav__link">
    CalcUA_sorted_archmap_keys
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#routines_3" class="md-nav__link">
    Routines
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="the-sitepackagelua-file-and-its-included-routines">The SitePackage.lua file and its included routines</h1>
<ul>
<li>
<p>SitePackage_map_toolchain.lua : Mapping regular toolchain names onto yyy.mm for
    comparisons to find matching versions of some files.</p>
</li>
<li>
<p>SitePackage_arch_hierarchy.lua : Routines to work with the hierarchy of
    architectures and map between long and short names.</p>
</li>
</ul>
<p>Some of the data structures, in particular those that need to be extended with each
new toolchain and really define the setup of the system, are not in the LMOD subdirectory
but instead in the file <code>etc/SystemDefinition.lua</code>.</p>
<h2 id="etcsystemdefinitionlua">etc/SystemDefinition.lua</h2>
<h3 id="calcua_systemtable"><code>CalcUA_SystemTable</code></h3>
<p><code>CalcUA_SystemTable</code> defines the whole structure of the software tree, including the manually
installed software and system-wide EasyBuild managed software. Note that the table will be
completed automatically with more generic os-cpu-accelerator architecture strings based
on the other tables in this file.</p>
<p><div class="highlight"><pre><span></span><code><span class="n">CalcUA_SystemTable</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">[</span><span class="s1">&#39;redhat7&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;x86_64&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="p">[</span><span class="s1">&#39;redhat8&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;x86_64&#39;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="p">[</span><span class="s1">&#39;manual&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">[</span><span class="s1">&#39;redhat7&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;x86_64&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="p">[</span><span class="s1">&#39;redhat8&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;x86_64&#39;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="p">[</span><span class="s1">&#39;2020a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">[</span><span class="s1">&#39;redhat7&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;ivybridge-noaccel&#39;</span><span class="p">,</span>
            <span class="s1">&#39;broadwell-noaccel&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="p">[</span><span class="s1">&#39;redhat8&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;zen2-noaccel&#39;</span><span class="p">,</span>
            <span class="s1">&#39;skylake-noaccel&#39;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">[</span><span class="s1">&#39;2021b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">[</span><span class="s1">&#39;redhat7&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;ivybridge-noaccel&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="p">[</span><span class="s1">&#39;redhat8&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;broadwell-noaccel&#39;</span><span class="p">,</span>
            <span class="s1">&#39;zen2-noaccel&#39;</span><span class="p">,</span>
            <span class="s1">&#39;skylake-noaccel&#39;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">},</span>
<span class="p">}</span>
</code></pre></div>
The structure is a table of tables.</p>
<ul>
<li>The keys on the first level are the versions of the software stacks, with two special version:
    <code>system</code> and <code>manual</code>.</li>
<li>The keys on the second level are the long OS versions (name+version as used in the 
    architecture identifiers)</li>
<li>The values are then the CPU architecture + accelerator for each software stack + OS combo.
    Only the most specific architecture needs to be given, the others are derived automatically
    from other tables.</li>
</ul>
<h3 id="calcua_systemproperies"><code>CalcUA_SystemProperies</code></h3>
<p><code>CalcUA_SystemProperies</code> adds additional information for each partition that is not contained
in <code>CalcUA_SystemTable</code>. It is a table of tables, the first index is the name of the calcua
stack or <code>manual</code> for the pseudo-stack of manually installed software. The table for each
software stack has the following entries:</p>
<ul>
<li>
<p><code>EasyBuild</code>: Default version of EasyBuild for this stack. Should not be defined for the
    manual stack.</p>
</li>
<li>
<p><code>hierarchy</code>: Type of architecture hierarchy used for this software stack. Currently only 
    the first option is implemented:</p>
<ol>
<li>
<p><code>2L_long</code>: two levels, the least generic level always includes an accelerator field</p>
</li>
<li>
<p><code>2L_short</code>: two levels, but the least generic level does not include an accelerator
    field if there is no accelerator</p>
</li>
<li>
<p><code>3L</code>: 3 levels in the architecture hierarchy.</p>
</li>
</ol>
</li>
</ul>
<h3 id="calcua_clustermap"><code>CalcUA_ClusterMap</code></h3>
<p><code>CalcUA_ClusterMap</code> contains for each version of the calcua toolchains, including
the dymmy system version, a mapping from cluster names to os-architecture strings.</p>
<div class="highlight"><pre><span></span><code><span class="n">CalcUA_ClusterMap</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">[</span><span class="s1">&#39;hopper&#39;</span><span class="p">]</span> <span class="o">=</span>      <span class="s1">&#39;redhat7-x86_64&#39;</span><span class="p">,</span>
        <span class="p">[</span><span class="s1">&#39;leibniz&#39;</span><span class="p">]</span> <span class="o">=</span>     <span class="s1">&#39;redhat8-x86_64&#39;</span><span class="p">,</span>
        <span class="p">[</span><span class="s1">&#39;leibniz-skl&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;redhat8-x86_64&#39;</span><span class="p">,</span>
        <span class="p">[</span><span class="s1">&#39;vaughan&#39;</span><span class="p">]</span> <span class="o">=</span>     <span class="s1">&#39;redhat8-x86_64&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">[</span><span class="s1">&#39;2020a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">[</span><span class="s1">&#39;hopper&#39;</span><span class="p">]</span> <span class="o">=</span>      <span class="s1">&#39;redhat7-ivybridge-noaccel&#39;</span><span class="p">,</span>
        <span class="p">[</span><span class="s1">&#39;leibniz&#39;</span><span class="p">]</span> <span class="o">=</span>     <span class="s1">&#39;redhat7-broadwell-noaccel&#39;</span><span class="p">,</span>
        <span class="p">[</span><span class="s1">&#39;leibniz-skl&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;redhat8-skylake-noaccel&#39;</span><span class="p">,</span>
        <span class="p">[</span><span class="s1">&#39;vaughan&#39;</span><span class="p">]</span> <span class="o">=</span>     <span class="s1">&#39;redhat8-zen2-noaccel&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">[</span><span class="s1">&#39;2021b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">[</span><span class="s1">&#39;hopper&#39;</span><span class="p">]</span> <span class="o">=</span>      <span class="s1">&#39;redhat7-ivybridge-noaccel&#39;</span><span class="p">,</span>
        <span class="p">[</span><span class="s1">&#39;leibniz&#39;</span><span class="p">]</span> <span class="o">=</span>     <span class="s1">&#39;redhat8-broadwell-noaccel&#39;</span><span class="p">,</span>
        <span class="p">[</span><span class="s1">&#39;leibniz-skl&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;redhat8-skylake-noaccel&#39;</span><span class="p">,</span>
        <span class="p">[</span><span class="s1">&#39;vaughan&#39;</span><span class="p">]</span> <span class="o">=</span>     <span class="s1">&#39;redhat8-zen2-noaccel&#39;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
</code></pre></div>
<p><code>CalcUA_ClusterMap</code> is an associative table-of-tables. </p>
<ul>
<li>On the first level, the keys are the various versions of the software stack visible to
    users (and can include <code>system</code>)</li>
<li>On the second level, the keys are the names of the clusters that we want to map on a 
    particular architecture.</li>
<li>The values are then the architecture strings, in the formats specified in 
    <code>CalcUA_SystemProperties</code>.</li>
</ul>
<h3 id="calcua_toolchain_map"><code>CalcUA_toolchain_map</code></h3>
<p><code>CalcUA_toolchain_map</code> is an associative table, with the yyyy[a|b] toolchains as the keys and
the matching yyyymm value as the value (note: no dot, not yyyy.mm)</p>
<p>Example:
<div class="highlight"><pre><span></span><code><span class="n">CalcUA_toolchain_map</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;200000&#39;</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">&#39;manual&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;200000&#39;</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">&#39;2020a&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="s1">&#39;202001&#39;</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">&#39;2020b&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="s1">&#39;202007&#39;</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">&#39;2021a&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="s1">&#39;202101&#39;</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">&#39;2021b&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="s1">&#39;202107&#39;</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">&#39;2022a&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="s1">&#39;202201&#39;</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></p>
<h3 id="calcua_map_arch_hierarchy"><code>CalcUA_map_arch_hierarchy</code></h3>
<p><code>CalcUA_map_arch_hierarchy</code> is an associative table of associative tables with for each supported
OS a table that can be used to determine the parent of every CPU/accelerator
architecture.</p>
<ul>
<li>
<p>First level: The keys are the yyyymm versions of toolchains, the values the matching
    associative table. These toolchain versions are "starting from", so not every toolchain
    needs to be specified.</p>
</li>
<li>
<p>Second level: Associative table with as keys the CPU/GPU architecture
    string and as value the parent GPU/architecture string, or <code>nil</code> if it is
    the top (= most generic) architecture.</p>
</li>
</ul>
<p>Example:
<div class="highlight"><pre><span></span><code><span class="n">CalcUA_map_arch_hierarchy</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1">-- We start with a 2-level map</span>
    <span class="p">[</span><span class="s1">&#39;200000&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">[</span><span class="s1">&#39;zen2-noaccel&#39;</span><span class="p">]</span>      <span class="o">=</span> <span class="s1">&#39;x86_64&#39;</span><span class="p">,</span>
        <span class="p">[</span><span class="s1">&#39;zen2-ampere&#39;</span><span class="p">]</span>       <span class="o">=</span> <span class="s1">&#39;x86_64&#39;</span><span class="p">,</span>
        <span class="p">[</span><span class="s1">&#39;zen2-arcturus&#39;</span><span class="p">]</span>     <span class="o">=</span> <span class="s1">&#39;x86_64&#39;</span><span class="p">,</span>
        <span class="p">[</span><span class="s1">&#39;broadwell-noaccel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;x86_64&#39;</span><span class="p">,</span>
        <span class="p">[</span><span class="s1">&#39;broadwell-P5000&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="s1">&#39;x86_64&#39;</span><span class="p">,</span>
        <span class="p">[</span><span class="s1">&#39;broadwell-pascal&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="s1">&#39;x86_64&#39;</span><span class="p">,</span>
        <span class="p">[</span><span class="s1">&#39;skylake-noaccel&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="s1">&#39;x86_64&#39;</span><span class="p">,</span>
        <span class="p">[</span><span class="s1">&#39;skylake-aurora1&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="s1">&#39;x86_64&#39;</span><span class="p">,</span>
        <span class="p">[</span><span class="s1">&#39;ivybridge-noaccel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;x86_64&#39;</span><span class="p">,</span>
        <span class="p">[</span><span class="s1">&#39;x86_64&#39;</span><span class="p">]</span>            <span class="o">=</span> <span class="kc">nil</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<h2 id="sitepackage_map_toolchainlua">SitePackage_map_toolchain.lua</h2>
<h3 id="data-structures">Data structures</h3>
<ul>
<li>Uses <code>CalcUA_toolchain_map</code> from <code>etc/SystemDefinition.lua</code></li>
</ul>
<h3 id="routines">Routines</h3>
<ul>
<li>
<p><code>map_toolchain</code>:  Returns the matching yyyy.mm toolchain for any toolchain. The
    input argument can be either a yyyy.mm toolchain version (in which case the
    routine simply returns that version without the dot) or a yyyy[a|b] version in
    which case the routine uses the <code>CalcUA_toolchain_map</code> to compute the matching
    yyyymm version or falls back to a default rule (where a becomes 01 and b becomes
    07).</p>
</li>
<li>
<p><code>get_versionedfile</code>: Finds the most recent file with version not younger than a
    given toolchain, with the file matching a particular pattern given as a directory,
    part before the version and part after the version. The version can be in any
    format supported by <code>map_toolchain</code>: yyyy[a|b], yyyy.mm, yyyymm, <code>system</code>.</p>
</li>
</ul>
<h2 id="sitepackage_arch_hierarchylua">SitePackage_arch_hierarchy.lua</h2>
<h3 id="data-structures_1">Data structures</h3>
<ul>
<li>Uses <code>CalcUA_map_arch_hierarchy</code> from <code>etc/SystemDefinition.lua</code>.</li>
</ul>
<h4 id="map_os_long_to_short"><code>map_os_long_to_short</code></h4>
<p><code>map_os_long_to_short</code> maps long names of the OS to their short equivalent
(name does not include the version).</p>
<p>Example:
<div class="highlight"><pre><span></span><code><span class="n">map_os_long_to_short</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">[</span><span class="s1">&#39;redhat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;RH&#39;</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></p>
<h4 id="map_cpu_long_to_short"><code>map_cpu_long_to_short</code></h4>
<p><code>map_cpu_long_to_short</code> maps the long CPU name to their short equivalent.</p>
<p>Example:
<div class="highlight"><pre><span></span><code><span class="n">map_cpu_long_to_short</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">[</span><span class="s1">&#39;x86_64&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="s1">&#39;x86_64&#39;</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">&#39;zen2&#39;</span><span class="p">]</span>      <span class="o">=</span> <span class="s1">&#39;zen2&#39;</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">&#39;ivybridge&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;IVB&#39;</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">&#39;broadwell&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;BRW&#39;</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">&#39;skylake&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="s1">&#39;SKLX&#39;</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></p>
<h4 id="map_accel_long_to_short"><code>map_accel_long_to_short</code></h4>
<p><code>map_accel_long_to_short</code> maps the accelerator architecture from their long
name to their short equivalent.</p>
<p>Example:
<div class="highlight"><pre><span></span><code><span class="n">map_accel_long_to_short</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">[</span><span class="s1">&#39;noaccel&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="s1">&#39;host&#39;</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">&#39;P5000&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="s1">&#39;NVGP61GL&#39;</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">&#39;pascal&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="s1">&#39;NVCC60&#39;</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">&#39;ampere&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="s1">&#39;NVCC80&#39;</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">&#39;arcturus&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;GFX908&#39;</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">&#39;aurora1&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="s1">&#39;NEC1&#39;</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></p>
<h3 id="routines_1">Routines</h3>
<h4 id="discover-the-architecture-hierarchy">Discover the architecture hierarchy</h4>
<ul>
<li>
<p><code>get_long_osarchs</code>: For a given OS (long name + version) and architecture
    (long name, CPU + optionally accelerator), return a table which also includes
    the parent and potentially grandparent of the architecture for the given OS.</p>
<p>The order in the table is from the least generic architecture to the most
generic one.</p>
</li>
<li>
<p><code>get_long_osarchs_reverse</code>: Same as <code>get_long_osarchs</code>, but now with the
    most generic one first and least generic one (the one used as the argument
    of the function) last.</p>
</li>
</ul>
<h4 id="mapping-between-different-formats-of-names">Mapping between different formats of names</h4>
<ul>
<li>
<p><code>map_long_to_short</code>: Map full long name (OS+version-CPU-accelerator) to the
    equivalent short name. It also works for names that do not include the
    accelerator.</p>
</li>
<li>
<p><code>map_short_to_long</code>: Map full short name (OS+version-CPU-accelerator) to the
    equivalent long name. It also works for names that do not include the
    accelerator.</p>
</li>
</ul>
<h4 id="extracting-parts-from-the-os-cpu-accelerator-strings">Extracting parts from the os-cpu-accelerator strings:</h4>
<ul>
<li>
<p><code>extract_os</code>  : Extracts the first part of the os-cpu-acceleartor argument</p>
</li>
<li>
<p><code>extract_cpu</code> : Extracts the second part of the os-cpu-accelerator argument</p>
</li>
<li>
<p><code>extract_accel</code> : Extracts the third part of the os-cpu-accelerator argument,
    or returns <code>nil</code> if there is no accelerator part in the argument.</p>
</li>
<li>
<p><code>extract_arch</code> : Extracts the second and (optional) third part of the
    os-cpu-accelerator argument, i.e., returns cpu-accelerator or just cpu if there
    is no accelerator part.</p>
</li>
</ul>
<h4 id="computing-directories">Computing directories</h4>
<ul>
<li>
<p><code>get_system_module_dir</code>: Compute the module directory from the three input arguments:
    long os-and-architecture name, stack name and stack version.</p>
<p>The directory name returned is relative from the installation root, with the most
generic one first.</p>
<p>Note <code>system</code> in the name does not denote the <code>system</code> stack but the whole
system installation, versus the user installation.</p>
</li>
<li>
<p><code>get_system_module_dirs</code>: Compute the module directory hierarchy from the three input
    arguments: long os-and-architecture name, stack name and stack version.</p>
<p>The directory names returned are relative from the installation root, with the most
generic one first.</p>
</li>
</ul>
<h2 id="sitepackage_system_infolua">SitePackage_system_info.lua</h2>
<h3 id="data-structures_2">Data structures</h3>
<p>This file needs several data structures to map properties detected on the system to 
the actual OS, CPU and accelerator names used in the module system.</p>
<p>Note that in the current implementation we maintain mappings to both the long and the
short names, and this has to be consistent with the various <code>map_*</code> tables in
<code>SitePackage_arch_hierarchy.lua</code>. </p>
<h4 id="mappings-to-long-names">Mappings to long names</h4>
<ul>
<li>
<p><code>cpustring_to_longtarget</code> is the mapping from the CPU string that can be found in
    <code>/proc/cpuinfo</code> to the names that are used in the module system. Several CPU strings
    can map to the same target.</p>
<p>Example:
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">cpustring_to_longtarget</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">AuthenticAMD_23_49</span> <span class="o">=</span> <span class="s1">&#39;zen2&#39;</span><span class="p">,</span>
    <span class="n">GenuineIntel_6_62</span>  <span class="o">=</span> <span class="s1">&#39;ivybridge&#39;</span><span class="p">,</span>
    <span class="n">GenuineIntel_6_79</span>  <span class="o">=</span> <span class="s1">&#39;broadwell&#39;</span><span class="p">,</span>
    <span class="n">GenuineIntel_6_85</span>  <span class="o">=</span> <span class="s1">&#39;skylake&#39;</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></p>
</li>
<li>
<p><code>osname_to_longos</code> is the mapping from the OS names are reported in <code>/etc/os-release</code>
    in the <code>NAME</code> field to the names used in the module system. Multiple values can map onto
    the same OS in the stack, e.g., all Red Hat compatible OSes map to a single name.</p>
<p>Example:
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">osname_to_longos</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">CentOS_Linux</span> <span class="o">=</span> <span class="s1">&#39;redhat&#39;</span><span class="p">,</span>
    <span class="n">Rocky_Linux</span>  <span class="o">=</span> <span class="s1">&#39;redhat&#39;</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></p>
</li>
<li>
<p><code>accelerator_to_shortacc</code> is a more tricky table. It is used in the mapping from data
    read from the output of <code>lspci</code> to accelerator names, but the keys are not currently the
    values read with <code>lspci</code>. These values are hard coded in the routine that does detect
    the accelerator.</p>
<p>Example:
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">accelerator_to_longacc</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">AMD_MI100</span>    <span class="o">=</span> <span class="s1">&#39;arcturus&#39;</span><span class="p">,</span>
    <span class="n">NVIDIA_GA100</span> <span class="o">=</span> <span class="s1">&#39;ampere&#39;</span><span class="p">,</span>
    <span class="n">NVIDIA_GP100</span> <span class="o">=</span> <span class="s1">&#39;pascal&#39;</span><span class="p">,</span>
    <span class="n">NVIDIA_GP104</span> <span class="o">=</span> <span class="s1">&#39;P5000&#39;</span><span class="p">,</span>
    <span class="n">NEC_aurora1</span>  <span class="o">=</span> <span class="s1">&#39;aurora1&#39;</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></p>
</li>
</ul>
<h4 id="mappings-to-short-names">Mappings to short names</h4>
<p>The structure of each of these associative tables is completely equivalent to their long
names equivalent, but using the short names as the value. </p>
<p>In principle they could be computed from the long names variants utilising the mapping 
tables from long to short names as defined in <code>SitePackage_arch_hierarchy.lua</code>.</p>
<ul>
<li><code>cpustring_to_shorttarget</code></li>
<li><code>osname_to_shortos</code></li>
<li><code>accelerator_to_shoracc</code></li>
</ul>
<h4 id="other-data-structures">Other data structures</h4>
<ul>
<li>
<p><code>os_version_type</code>: Indicates if for the OS we should use the major version only or 
    a major.minor version to distinguish architectures for the software stack.</p>
<p>The need grew out of a difference between CentOS which only reports the major version
in <code>/etc/os-release</code> in the <code>VERSION_ID</code> field and Rocky Linux which reports a major.minor
version, while we still use only the major version in the software stack.</p>
<p>Example
<div class="highlight"><pre><span></span><code><span class="kd">local</span> <span class="n">os_version_type</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">CentOS_Linux</span> <span class="o">=</span> <span class="s1">&#39;major&#39;</span><span class="p">,</span>
    <span class="n">Rocky_Linux</span>  <span class="o">=</span> <span class="s1">&#39;major&#39;</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></p>
</li>
</ul>
<h3 id="routines_2">Routines</h3>
<ul>
<li>
<p><code>get_hostname</code>: Request the name of the host. The routine calls <code>/bin/hostname</code>.</p>
</li>
<li>
<p><code>get_cpu_info</code>: Returns the CPU string read from <code>/proc/cpuinfo</code>, by combining 
    information from the <code>vendor_id</code>, <code>family</code> and <code>model</code> lines (separated by an
    underscore).</p>
</li>
<li>
<p><code>get_os_info</code> returns 2 values: name and version of the OS. The name is extracted
    from the <code>NAME</code> line of <code>/etc/os-release</code>, the version from the <code>VERSION_ID</code> line
    but it may be converted from major.minor to major format if told so by the 
    <code>os_version_type</code> table.</p>
</li>
<li>
<p><code>get_accelerator_info</code> extracts the accelerator type, returning <code>nil</code> if no accelerator
    is found. The names returned are the long accelerator names used in the data structures.</p>
</li>
<li>
<p><code>get_clusterarch</code> returns the cluster architecture in four possible formats for the 
    module system. It is then to the module system to select which one of the four it needs
    for which purpose (and that depends on the <code>hierarchy</code> field in <code>CalcUA_SystemProperties</code>
    in <code>/etc/SysteDefinition.lua</code>). The four formats are two with long names and two with
    short names, each time with three components or with only two components if there is no
    accelerator.</p>
</li>
<li>
<p><code>get_fullos</code>: Returns the long OS name including the version (so the first component
    of the formats with long names of <code>get_clusterarch</code>)</p>
<p>Example return value: <code>redhat8</code> on systems with CentOS 8.x or Rocky Linux 8.x.</p>
</li>
</ul>
<h2 id="sitepackage_helperlua">SitePackage_helper.lua</h2>
<p>This file defines data structures derived from other data structures mentioned earlier
on this page, which implies that the order of <code>dofile</code> commands is important as the 
initialisation code is executed when the file is included.</p>
<h3 id="data-structures_3">Data structures</h3>
<h4 id="calcua_sorted_archmap_keys"><code>CalcUA_sorted_archmap_keys</code></h4>
<p>This data structure is a sorted list of the level 1 keys used in the 
<a href="#calcua_map_arch_hierarchy"><code>CalcUA_map_arch_hierarchy</code></a> data structure.
Its main purpose is to speed up a search routine in this file, to avoid always 
recomputing that data.</p>
<h3 id="routines_3">Routines</h3>
<ul>
<li>
<p><code>get_matching_archmap_key</code>: For a given numeric (i.e., yyyymm) version, returns
    the largest key in <code>CalcUA_map_arch_hierarchy</code> not larger than the given version.</p>
</li>
<li>
<p><code>mkDir</code>: Create a directory, using the Lua <code>lfs</code> package. It really has the effect
    effect of <code>mkdir -p</code>, so it can create multiple levels from the given directory if
    needed.</p>
</li>
</ul>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">April 12, 2022</span>
      
    
  </small>
</div>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../modules_calcua_and_clusterarch/" class="md-footer__link md-footer__link--prev" aria-label="Previous: The generic calcua and clusterarch modules" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              The generic calcua and clusterarch modules
            </div>
          </div>
        </a>
      
      
        
        <a href="../easybuild/" class="md-footer__link md-footer__link--next" aria-label="Next: EasyBuild configuration" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              EasyBuild configuration
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    <a href="https://github.com/hpcuantwerpen" target="_blank" rel="noopener" title="HPC-UAntwerpen on GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tracking", "navigation.top", "navigation.indexes", "header.autohide", "toc.follow", "content.code.annotate"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.bd0b6b67.min.js"}</script>
    
    
      <script src="../assets/javascripts/bundle.467223ff.min.js"></script>
      
    
  </body>
</html>

<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for the UAntwerpen-modules repository">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.2.5">
    
    
      
        <title>Design decisions - UAntwerpen-modules documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2d9f7617.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#design-decisions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="UAntwerpen-modules documentation" class="md-header__button md-logo" aria-label="UAntwerpen-modules documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            UAntwerpen-modules documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Design decisions
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent=""  aria-hidden="true"  type="radio" name="__palette" id="__palette_1">
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="UAntwerpen-modules documentation" class="md-nav__button md-logo" aria-label="UAntwerpen-modules documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    UAntwerpen-modules documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Design decisions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Design decisions
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#software-stack-modules" class="md-nav__link">
    Software stack modules
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#directory-structure" class="md-nav__link">
    Directory structure
  </a>
  
    <nav class="md-nav" aria-label="Directory structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration-part-of-the-tree" class="md-nav__link">
    Configuration part of the tree
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optional-repository-part-of-the-tree" class="md-nav__link">
    (Optional) repository part of the tree
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#module-part-of-the-tree" class="md-nav__link">
    Module part of the tree
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#software-directory-sw" class="md-nav__link">
    Software directory SW
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manangement-subdirectory" class="md-nav__link">
    Manangement subdirectory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-subdirectories" class="md-nav__link">
    Other subdirectories
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../modules_calcua-init/" class="md-nav__link">
        The CalcUA-init module
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../modules_calcua_and_clusterarch/" class="md-nav__link">
        The generic calcua and clusterarch modules
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../scripts/" class="md-nav__link">
        Scripts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../SitePackage/" class="md-nav__link">
        The SitePackage.lua file and its included LUA files
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../easybuild/" class="md-nav__link">
        EasyBuild configuration
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../directory_structure/" class="md-nav__link">
        Directory structure of the repositories and software stack
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../procedures/" class="md-nav__link">
        Procedures
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../Development/">Development</a>
          
            <label for="__nav_10">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Development" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Development
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Development/debug_scripts/" class="md-nav__link">
        Test scripts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../Development/design_considerations/" class="md-nav__link">
        Design considerations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#software-stack-modules" class="md-nav__link">
    Software stack modules
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#directory-structure" class="md-nav__link">
    Directory structure
  </a>
  
    <nav class="md-nav" aria-label="Directory structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration-part-of-the-tree" class="md-nav__link">
    Configuration part of the tree
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optional-repository-part-of-the-tree" class="md-nav__link">
    (Optional) repository part of the tree
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#module-part-of-the-tree" class="md-nav__link">
    Module part of the tree
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#software-directory-sw" class="md-nav__link">
    Software directory SW
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manangement-subdirectory" class="md-nav__link">
    Manangement subdirectory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-subdirectories" class="md-nav__link">
    Other subdirectories
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="design-decisions">Design decisions</h1>
<h2 id="software-stack-modules">Software stack modules</h2>
<ul>
<li>
<p>The software stack has two levels:</p>
<ol>
<li>Version of the software stack: <code>calcua</code> module.</li>
<li>Hardware architecture</li>
</ol>
<p>However, when loading a module from the first level we try to automatically 
determine the most suitable module for the second level.</p>
</li>
<li>
<p>A hardware architecture can have subarchitectures, see the discussion in 
    the <a href="../modules_calcua_and_clusterarch/">"The generic calcua and clusterarch modules" page</a>.</p>
<p>The final decision is to go for only two levels: a generic one and one
specialised for the full architecture (including the accelerator) though
the implementation is done such that this could be changed for a later
version of the software stack. It will create a lot more files as a lot more
packages will be installed multiple times, but it reduces complexity and the
chance for error of installing a package at the wrong level.</p>
</li>
<li>
<p>The latter implies that we will need a double tree of modules</p>
<ul>
<li>
<p>One follows very strictly the Lmod hierarchy rules. Only one directory at any level
    of this tree can be present in the <code>MODULEPATH</code>. This tree is called the
    <strong>infrastructure modules</strong>.</p>
</li>
<li>
<p>The second tree contains the actual software. Multiple subdirectories from
    this tree can be in the <code>MODULEPATH</code> at the same time, e.g., the directory
    for modules compiled with generic options and directory with modules 
    optimised for a specific node type.</p>
</li>
</ul>
<p>To ensure that module swapping works correctly in Lmod (with Lmod trying to find
equivalent versions when changing the hardware architecture), it is important
that each software package is installed at one and only one level in the architecture
hierarchy. So one should install a package either only for the generic architecture,
or for all relevant specific architectures, but not in a generic way and some specific
architectures.</p>
</li>
<li>
<p>The module <code>calcua/system</code> is a <em>special version</em> of the <code>calcua</code> module for software
    that fulfills two requirements:</p>
<ol>
<li>We want it to be available for any regular version of the <code>calcua</code> stack</li>
<li>It is build using the <code>SYSTEM</code> toolchain (or installed in an equivalent way)</li>
</ol>
<p>This is basically the tree to install software from binaries or to create modules for
manually installed software (e.g., MATLAB and MAPLE).</p>
<p>The code of the module tree is largely prepared to have an architecture hierarchy
there too, but we may not use it initially. The tree could be used to, e.g.,
accomodate Gaussian and automatically offer the right version rather than have multiple
versions with versionsuffix for the architecture.</p>
</li>
<li>
<p>3 modules are needed to configure EasyBuild (though they are implemented as one generic
    module):</p>
<ul>
<li>
<p><code>EasyBuild-infrastructure</code> for the few modules that need to be installed in the 
    infrastructure tree (if any as on LUMI where this approach is also used basically
    only the toolchains are installed with EasyBuild, and they only belong in the
    infrastructure tree tp be able to always load the correct target modules as
    needed by the HPE Cray Programming Environment).</p>
</li>
<li>
<p><code>EasyBuild-production</code> for installing software with EasyBuild in the central software
    stack</p>
</li>
<li>
<p><code>EasyBuild-user</code> for installing software with EasyBuild in the user's directories.</p>
</li>
</ul>
</li>
<li>
<p>We support a 3-level and a 2-level naming scheme.</p>
<ul>
<li>
<p>At the top level and the bottom level (most generic level) there is no difference 
    between both schemes.</p>
<ul>
<li>
<p>Top level always uses 3-component names: OS-CPU-Accelerator.</p>
</li>
<li>
<p>Generic level names do not include an accelerator.</p>
</li>
</ul>
</li>
<li>
<p>In the <code>CalcUA_SystemTable</code> that defines which architectures have software stacks 
    for which stack version, only generic CPU names or CPU-Accelerator pairs are
    supported</p>
<p>Impact of omitting that restriction and supporting a module and software hierarchy </p>
<ul>
<li>
<p>Changes to the <code>get_calcua_top</code> function needed.</p>
</li>
<li>
<p>Needs changes to <code>get_long_osarchs</code> and <code>get_long_osarchs_reverse</code>.</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="directory-structure">Directory structure</h2>
<p>Separate module roots for infrastructure modules that follow a strict
Lmod hierarchy and for the easybuild-managed modules that are arranged 
by software stack and architecture.</p>
<p>We also put software and modules build with EasyBuild in two fully
separate trees in the installation root rather than always putting
the software and its modules next to each other as is done in the
default EasyBuild configuration.
We have chosen this option to be able to use short names for software directories
without reducing the readability of the names of the module file directories, and 
as such also to keep the size of shebang lines with full paths under control to not
hit kernel-imposed limits.</p>
<h3 id="configuration-part-of-the-tree">Configuration part of the tree</h3>
<p>At the top of the hierarchy, in the installation root, there is an
<code>etc</code> subdirectory with currently only the <code>SoftwareStack.lua</code> configuration
file which is created automatically by the software stack installation script
and is used to point to a number of important files and (sub)directories:</p>
<ol>
<li>The LUA system definition file that should be used</li>
<li>The repository with the LMOD configuration and generic modules (see below)</li>
<li>The repository with the whole EasyBuild setup, including custom EasyBlocks and
    custom EasyConfigs.</li>
</ol>
<p><strong><em>Configuration part of the tree</em></strong>
<div class="highlight"><pre><span></span><code>apps
└─ antwerpen
    └─ CalcUA
        └─ etc
</code></pre></div></p>
<h3 id="optional-repository-part-of-the-tree">(Optional) repository part of the tree</h3>
<p>At the top of the hierarchy, in the installation root, we find the GitHub
repositories with the module system and the EasyBuild configuration, the roots
of the infrastructure module system and the EasyBuild module system, the software
packages tree, and the EasyBuild repo of installed software.</p>
<p>Though both repositories are needed for the stack to work, it is possible to have
them elsewhere, which may be a good option for test stacks or for development
where you may want the repositories in a place that works better with your 
remote software development tools.</p>
<p><strong><em>(Optional) repository part of the tree</em></strong><br />
<div class="highlight"><pre><span></span><code>apps
└─ antwerpen
    └─ CalcUA
        ├─ UAntwerpen-modules <span class="c1">#(1)</span>
        └─ UAntwerpen-easybuild <span class="c1">#(2)</span>
            └─ easybuild
            ├─ easyconfigs
            ├─ easyblocks
            ├─ Customisations to naming schemes etc
            └─ config <span class="c1">#(3)</span>
</code></pre></div></p>
<ol>
<li>Repository with LMOD configuration and generic modules</li>
<li>EasyBuild setup</li>
<li>Configuration files for some settings not done via environment</li>
</ol>
<h3 id="module-part-of-the-tree">Module part of the tree</h3>
<ul>
<li>
<p>We distinguish between two types of system-wide installed software that is not using
    EasyBuild toolchains (except <code>SYSTEM</code>):</p>
<ul>
<li>
<p>Software installed via EasyBuild (though with some tricks)  That software appears
    in the EasyBuild-managed modules and EasyBuild repo also.</p>
<p>The software is installed via a dummy version of the calcua software stack
(<code>calcua/system</code>) with its own copy of EasyBuild.  </p>
</li>
<li>
<p>Software installed without using EasyBuild, with modules that are generated 
    via dummy EasyConfig files in the EasyBuild hierarchy.</p>
</li>
</ul>
</li>
<li>
<p>Infrastructure modules: <code>modules-infrastructure</code></p>
<ul>
<li>
<p>The hierarchy is build using the long names for the architecture string</p>
</li>
<li>
<p><code>init-UAntwerpen-modules</code>: Outside the hierarchy: Subdirectory for the module(s) that 
    initialises the whole module setup.</p>
<p>Loading the initialisation module enables loading of the next level, the software
stack modules.</p>
</li>
<li>
<p><code>stacks</code> subdirectory contains the modules for the software stack, currently only
    <code>calcua</code> modules, but that leaves room for a different software stack, e.g., EESSI, 
    later onn.</p>
<p>Loading of a <code>calcua</code> module enables the next level, loading of an architecture
module.</p>
</li>
<li>
<p><code>arch</code> subdirectory contains the architecture modules (or cluster modules).</p>
<p>2 levels of subdirectories before you reach the architecture modules:</p>
<ol>
<li>
<p>Name of the stack: <code>calcua</code></p>
</li>
<li>
<p>Version of the stack</p>
</li>
</ol>
<p>Modules named after the cluster could be easier to recognise for some users. However,
it may also be tricky to implement. Instead we can also use cluster names as the version
of the <code>arch</code> modules, and this is organised via <code>.modulerc.lua</code> files for each software
stack in the <code>arch</code> module subdirectory.</p>
<p>Loading an architecture module enables the next step in the hierarchy, loading the 
infrastructure modules and software modules.</p>
</li>
<li>
<p><code>infrastructure</code> subdirectory then contains the specific infrastructure modules, e.g.,
    the EasyBuild configuration modules.</p>
<p>4 levels of subdirectories before you reach the infrastructure modules</p>
<ol>
<li>
<p>Name of the stack: <code>calcua</code></p>
</li>
<li>
<p>Version of the stack</p>
</li>
<li>
<p><code>arch</code></p>
</li>
<li>
<p>Long name string of the architecture (OS-CPU-Accelerator except for OS-x86_64).</p>
</li>
</ol>
</li>
</ul>
</li>
<li>
<p>EasyBuild-managed modules: <code>modules-easybuild</code></p>
<p>Here we treat the system-wide installed software which is independent from any calcua software
stack as a separate software stack without version  Architecture-wise both are treated the same,
though we expect that most if not all system-wide installed software will be installed in a
generic architecture subdirectory.</p>
<p>2 levels before arriving at the actual infrastructure modules:</p>
<ol>
<li>
<p>Name-version of the software stack, e.g., <code>calcua-2021b</code> or <code>system</code></p>
</li>
<li>
<p>Architecture string</p>
</li>
</ol>
</li>
<li>
<p>Manually managed modules: <code>modules-manual</code></p>
<p>A space to put modules for the manually installed software in case we want to hand-code 
these modules rather then inject them elsewhere via EasyBuild.</p>
<p>The precise structure will be determined when the need arrises.</p>
</li>
<li>
<p>This leads to the following view on the modules tree:</p>
<div class="highlight"><pre><span></span><code>apps
└─ antwerpen
   └─ CalcUA
      ├─ modules-infrastructure <span class="c1">#(1)</span>
      │  ├─ init-UAntwerpen-modules <span class="c1">#(2)</span>
      │  ├─ stacks <span class="c1">#(3)</span>
      │  │  └─ calcua
      │  │     └─ 2021b.lua <span class="c1">#(4)</span>
      │  ├─ arch <span class="c1">#(5)</span>
      │  │  └─ calcua
      │  │     ├─ 2021b
      │  │     │  └─ arch
      │  │     │     ├─ redhat8-x86_64
      │  │     │     ├─ redhat8-broadwell-noaccel
      │  │     │     └─ redhat8-broadwell-quadro
      │  │     └─ system
      │  │        └─ arch
      │  │           ├─ redhat8-x86_64
      │  │           └─ redhat8-ivybridge-noaccel
      │  └─ infrastructure <span class="c1">#(6)</span>
      │     └─ CalcUA
      │        └─ 2021b
      │           └─ arch
      │               └─ redhat8-ivybridge-noaccel
      │                  ├─ EasyBuild-production
      │                  ├─ EasyBuild-infrastructure
      │                  └─ EasyBuild-user
      ├─ modules-easybuild <span class="c1">#(7)</span>
      │  ├─ CalcUA-2021b
      │  │  ├─ redhat8_x86_64 <span class="c1">#(8)</span>
      │  │  ├─ redhat8-broadwell-noaccel
      │  │  └─ redhat8-broadwell-quadro
      │  └─ system* <span class="c1">#(9)!</span>
      │     ├─ redhat8-x86_64 <span class="c1">#(10)</span>
      │     └─ redhat8-ivybridge-noaccel <span class="c1">#(11)</span>
      └─ modules-manual <span class="c1">#(12)!</span>
</code></pre></div>
<ol>
<li>Lmod hierarchy as the framework of the module system </li>
<li>Subdirectory for the startup module</li>
<li>First level: Software stack modules</li>
<li>Symbolic link to a generic module!</li>
<li>Second level: Architecture of the stack</li>
<li>Third level: Infrastructure modules, e.g., EasyBuild configuration</li>
<li>Modules generated with EasyBuild</li>
<li>Directory for potential generic builds if performance does not matter</li>
<li>Modules outside the regular software stacks</li>
<li>No specific processor versions, e.g., Matlab</li>
<li>Specific processor version, e.g., Gaussian</li>
<li>Manually generated modules - OPTIONAL</li>
</ol>
</li>
</ul>
<h3 id="software-directory-sw">Software directory <code>SW</code></h3>
<p>This directory follows the same layout as the one for the EasyBuild-installed software,
with two differences:</p>
<ol>
<li>
<p>At the architecture level, the short architecture string is used to save space</p>
</li>
<li>
<p>There is yet another pseudo-stack for manually installed software, called <code>MNL</code>  </p>
<p>This directory has no corresponding modules directory in the EasyBuild-managed directory
as it is not managed at all by EasyBuild.</p>
</li>
</ol>
<p><strong><em>Resulting structure of the software directory</em></strong><br />
<div class="highlight"><pre><span></span><code>apps
└─ antwerpen
    └─ CalcUA
        └─ SW
            ├─ CalcUA-2021b
            │  ├─ RH8-x86_64
            │  ├─ RH8-BRW-host
            │  └─ RH8-BRW-NVGP61GL
            ├─ system <span class="c1">#(1)</span>
            │  ├─ RH8-x86_64
            │  └─ RH8-IVB-host
            └─ MNL <span class="c1">#(2)</span>
</code></pre></div></p>
<ol>
<li>Sometimes relatively empty subdirs if EasyBuild only creates a module...</li>
<li>Manually installed software</li>
</ol>
<h3 id="manangement-subdirectory">Manangement subdirectory</h3>
<p><code>mgmt</code> subdirectory for all (nearly) files that are somehow system-generated.</p>
<p>Current subdirectories:</p>
<ul>
<li>
<p><code>ebrepo_files</code>: EasyBuild repository, structured the same way as the <code>modules-easybuild</code>
    subdirectory.</p>
</li>
<li>
<p><code>lmod-cache</code>: Placeholder for Lmod cache files.</p>
<p>Maybe we should follow the approach of TCL Environment Modules 5 and have a separate cache
file per module subdirectory, or does this become too much? We can also go for one corresponding to each software stack and cluster architecture combination which would
result in a single file per ( software stack, architecture) combination.</p>
</li>
</ul>
<p><strong><em>Resulting structure of the management directory</em></strong><br />
<div class="highlight"><pre><span></span><code>apps
└─ antwerpen
    └─ CalcUA
        └─ mgmt
            ├─ ebrepo_files
            │  ├─ CalcUA-2021b
            │  │ ├─ redhat8-x86_64
            │  │ └─ redhat8-broadwell-noaccel
            │  └─ system <span class="c1">#(1)</span>
            │     └─ redhat8-x86_64 <span class="c1">#(2)</span>
            └─ lmod_cache
</code></pre></div></p>
<ol>
<li>Modules outside the regular software stacks</li>
<li>No specific processor versions, e.g., Matlab</li>
</ol>
<h3 id="other-subdirectories">Other subdirectories</h3>
<ul>
<li>
<p><code>sources</code> subdirectory to permanently store the sources. This directory is
    further organised in the EasyBuild way. Downloads for manually installed
    software can be added to it by putting it in the EasyBuild structure.</p>
<p>In the future we may need to add an additional level to distinguish between
EasyBuild and other build tools that we may use and that have a different
structure for storing source files.</p>
</li>
</ul>
<p><strong><em>Other subdirectories</em></strong>
<div class="highlight"><pre><span></span><code>apps
└─ antwerpen
    └─ CalcUA
        └─ sources
</code></pre></div></p>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">July 6, 2022</span>
      
    
  </small>
</div>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href=".." class="md-footer__link md-footer__link--prev" aria-label="Previous: Overview" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Overview
            </div>
          </div>
        </a>
      
      
        
        <a href="../modules_calcua-init/" class="md-footer__link md-footer__link--next" aria-label="Next: The CalcUA-init module" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              The CalcUA-init module
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    <a href="https://github.com/hpcuantwerpen" target="_blank" rel="noopener" title="HPC-UAntwerpen on GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tracking", "navigation.top", "navigation.indexes", "header.autohide", "toc.follow", "content.code.annotate", "search.suggest"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.bd0b6b67.min.js"}</script>
    
    
      <script src="../assets/javascripts/bundle.467223ff.min.js"></script>
      
    
  </body>
</html>